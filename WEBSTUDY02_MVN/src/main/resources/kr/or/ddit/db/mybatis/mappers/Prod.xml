<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="kr.or.ddit.prod.dao.IProdDAO">

	<resultMap type="prodVO" id="prodMap" autoMapping="true">
		<id property="prod_id" column="PROD_ID"/>
		<association property="buyer" javaType="BuyerVO" autoMapping="true"></association>
	</resultMap>
	
	<select id="selectProd" parameterType="String" resultMap="prodMap">
		SELECT PROD_ID, PROD_NAME, PROD_PRICE, PROD_OUTLINE
			,PROD_DETAIL, PROD_TOTALSTOCK, PROD_DELIVERY
			,PROD_COST, PROD_IMG, PROD_INSDATE, PROD_SIZE, PROD_COLOR
			,LPROD_NM
			,BUYER_NAME, BUYER_CHARGER, BUYER_COMTEL, BUYER_ADD1
		FROM PROD 
		    INNER JOIN LPROD ON PROD_LGU = LPROD_GU
		    INNER JOIN BUYER ON PROD_BUYER = BUYER_ID
		WHERE PROD_ID = #{PROD_ID}
	</select>
	
	<select id="selectProdList" resultMap="prodMap" parameterType="PagingVO">
		SELECT B.* 
		FROM (
		    SELECT A.* , ROWNUM as rnum
		    FROM(
		        select prod.ROWID RID, PROD_ID, LPROD_NM, PROD_NAME, 
		        BUYER_NAME, PROD_COST, PROD_PRICE, PROD_MILEAGE
		            from prod
		            INNER JOIN LPROD ON PROD_LGU = LPROD_GU
		            INNER JOIN BUYER ON PROD_BUYER = BUYER_ID
		        order by RID DESC
		        ) A
		    ) B
		<![CDATA[
		WHERE RNUM >= #{startRow} AND RNUM <= #{endRow}
		]]>
	</select>
	
	<select id="selectTotalRecord" resultType="int">
		SELECT COUNT(*)
		FROM PROD
	</select>
	
</mapper>